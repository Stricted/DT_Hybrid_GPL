diff -uPr samba-3.0.33/source/client/mount.cifs.c samba-3.0.33-CVE-2011-2724/source/client/mount.cifs.c
--- samba-3.0.33/source/client/mount.cifs.c	2011-07-29 12:58:40.035518428 -0400
+++ samba-3.0.33-CVE-2011-2724/source/client/mount.cifs.c	2011-07-29 13:00:57.234973175 -0400
@@ -1194,8 +1194,7 @@
 static int check_mtab(const char *progname, const char *devname,
 			const char *dir)
 {
-	if (check_newline(progname, devname) == -1 ||
-	    check_newline(progname, dir) == -1)
+	if (check_newline(progname, devname) || check_newline(progname, dir))
 		return EX_USAGE;
 	return 0;
 }
